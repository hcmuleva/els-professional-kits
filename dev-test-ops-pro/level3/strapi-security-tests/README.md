# 🔒 Strapi Security Testing Kit

Comprehensive security testing suite for Strapi APIs using OWASP ZAP.

## 🚀 Quick Start

### 1. Start ZAP Container
```bash
docker-compose up -d
```

### 2. Verify Setup
```bash
docker ps | grep zap
```

### 3. Run Your First Scan
```bash
./security/scripts/baseline-scan.sh
```

### 4. View Report
```bash
open security/reports/html/baseline_scan_*.html
```

## 📊 Available Scans

### Baseline Scan (Quick - 5-10 min)
```bash
./security/scripts/baseline-scan.sh
```
Tests: OWASP Top 10, SQL Injection, XSS, Security Headers

### Full Scan (Comprehensive - 30-60 min)
```bash
export STRAPI_USER="your-email@example.com"
export STRAPI_PASS="your-password"
./security/scripts/full-scan.sh
```
Tests: All vulnerabilities with active scanning

### API Scan (Targeted - 15-20 min)
```bash
./security/scripts/api-scan.sh
```
Tests: API-specific vulnerabilities

### Authenticated Scan (With JWT - 20-30 min)
```bash
export STRAPI_USER="your-email@example.com"
export STRAPI_PASS="your-password"
./security/scripts/authenticated-scan.sh
```
Tests: Protected endpoints with authentication

### Interactive Menu
```bash
./security/scripts/run-security-scan.sh
```

## 📁 Project Structure

```
strapi-security-tests/
├── docker-compose.yml
├── security/
│   ├── scripts/          # Scan scripts
│   ├── reports/          # Generated reports
│   ├── configs/          # Configuration files
│   └── context/          # ZAP context files
├── test-data/            # Test credentials and endpoints
└── README.md
```

## 🔧 Configuration

Update your credentials in `test-data/test-credentials.json`:

```json
{
  "credentials": {
    "username": "your-email@example.com",
    "password": "your-password"
  }
}
```

## 📊 Understanding Reports

- **High** 🔴: Fix immediately
- **Medium** 🟡: Fix in next sprint  
- **Low** 🟢: Fix when possible
- **Informational** 🔵: Review and note

## 🆘 Troubleshooting

### ZAP Container Not Starting
```bash
docker-compose down
docker-compose up -d
docker logs strapi-zap-security
```

### Cannot Connect to Strapi
Ensure Strapi is running:
```bash
curl http://localhost:1337
```

### Authentication Fails
1. Verify credentials in Strapi admin
2. Check user has proper permissions
3. Test login manually first

## 📚 Resources

- [OWASP ZAP Documentation](https://www.zaproxy.org/docs/)
- [Strapi Security](https://docs.strapi.io/developer-docs/latest/setup-deployment-guides/configurations/optional/middlewares.html#security)
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)

## 🎯 Next Steps

1. Run baseline scan
2. Review results
3. Fix high-priority issues
4. Re-scan to verify
5. Schedule regular scans

---

Generated by Strapi Security Testing Kit Generator
